# 部署指南

> 这份指南简要介绍了线上服务器的部署环境
> 
> 线上环境分为开发环境和生产环境，相互独立

**开发中的所有操作请使用开发环境域名和变量**

## 生产环境

所有端口都是用`nginx`来反代的，`nginx`运行环境为

|   用户    |     组     |
| :-------: | :--------: |
| `weiyang` | `www-data` |

`weiyang`是专门用于生产环境的非特权账户，所以所有的生产代码和生产数据都应该放在`weiayng`账户下，可以通过如下命令进入：

```bash
sudo su - weiyang
```

在`/home/weiyang/deploy`下面放生产环境代码

下面是地址信息

|  项目   |         本地地址         |          外部地址           |              备注              |
| :-----: | :----------------------: | :-------------------------: | :----------------------------: |
| API后端 | `uwsgi://127.0.0.1:5000` |   `https://api.thuwy.top`   |                                |
| web前端 |      `/var/www/web`      |   `https://web.thuwy.top`   |                                |
| web后端 | `http://127.0.0.1:5020`  | `https://web.thuwy.top/api` | 目前主要处理图片上传和网页登陆 |
| 存储端  | `http://127.0.0.1:5010`  | `https://static.thuwy.top`  |                                |

> API后端目前还是使用uwsgi协议，后续未央2.0正式上线后切换为普通http协议



## 开发环境

开发环境使用`ubuntu`用户，在`/home/ubuntu/development`下面放开发环境代码

下面是地址信息

|  项目   |        本地地址         |            外部地址             |              备注              |
| :-----: | :---------------------: | :-----------------------------: | :----------------------------: |
| API后端 | `http://127.0.0.1:6000` |   `https://dev-api.thuwy.top`   |                                |
| web前端 |   `/var/www/dev-web`    |   `https://dev-web.thuwy.top`   |                                |
| web后端 | `http://127.0.0.1:6020` | `https://dev-web.thuwy.top/api` | 目前主要处理图片上传和网页登陆 |
| 存储端  | `http://127.0.0.1:6010` | `https://dev-static.thuwy.top`  |                                |
